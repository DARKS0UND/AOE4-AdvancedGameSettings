---------------------------------------------------------------------------------------------------
-- Authors:
-- Relic
-- Woprock
--
-- Description:
-- Overwrites any cardinal inherited functions to ensure AGS functionality.
-- Keep global knowledge of AGS focused here for easy reference.
---------------------------------------------------------------------------------------------------

---------------------------------------------------------------------------------------------------
-- Imports:
-- Order of imports defines oder of event handles. Beware of it when intruducing dependencies.
---------------------------------------------------------------------------------------------------

-- Core import that enables match to start.
import("cardinal.scar")
-- Core import that holds all AGS data workflow.
import("ags_global_settings.scar")
-- Core import that contains helpers for all AGS scripts.
import("helpers/ags_blueprints.scar")
-- Necessary import for AI hacks.
import("ai/ags_ai.scar")
-- High priority start conditions.
import("startconditions/ags_start_nomad.scar")
import("startconditions/ags_start_scattered.scar")
import("startconditions/ags_start_settled.scar")
import("startconditions/ags_start_keep.scar")
import("startconditions/ags_start_king.scar")
-- Low priority start conditions.
import("startconditions/ags_initial_age.scar")
import("startconditions/ags_technologies.scar")
import("startconditions/ags_final_age.scar")
-- Low priority that requires other modules.
import("startconditions/ags_reveal_spawn.scar")
-- Low priority gameplay customizations that do not have dependencies.
import("gameplay/ags_ding.scar")
import("gameplay/ags_early_market.scar")
import("gameplay/ags_game_rates.scar")
import("gameplay/ags_population_capacity.scar")
import("gameplay/ags_score.scar")
import("gameplay/ags_simulation_speed.scar")
import("gameplay/ags_testing.scar")
import("gameplay/ags_town_center_limit.scar")
import("gameplay/ags_tree_bombardment.scar")
import("gameplay/ags_map_vision.scar")
import("gameplay/ags_shared_vision.scar")
-- Low priority tutorial goals for new players.
import("training/coretraininggoals.scar")
import("training/frenchtraininggoals.scar")
import("training/englishtraininggoals.scar")
import("training/sultanatetraininggoals.scar")
import("training/rustraininggoals.scar")
import("training/mongoltraininggoals.scar")
import("training/chinesetraininggoals.scar")
import("training/abbasidtraininggoals.scar")
-- Additional UI support for match.
import("gameplay/event_cues.scar")
import("gameplay/currentageui.scar")
import("gameplay/chi/current_dynasty_ui.scar")
-- Conditions can be loaded as last, they might require others to propagete first.
import("conditions/ags_treaty.scar")

-- Unfinished rework continues after that
import("gameplay/ags_utilities.scar")




-- gameplay systems
import("gameplay/diplomacy_reworked.scar")
-- When conquest, religious, and wonder are all unselected in match options
import("winconditions/annihilation_reworked.scar")	
-- For players who quit or drop (through pause menu or disconnection)
import("winconditions/elimination_reworked.scar")	
-- For players who surrender (through pause menu)
import("winconditions/surrender_reworked.scar")		
import("winconditions/conquest.scar")
import("winconditions/sudden_death.scar") 
--import("winconditions/wonder.scar")
--import("winconditions/religious.scar")
import("winconditions/wonder_reworked.scar")
import("winconditions/religious_reworked.scar")
import("winconditions/regicide.scar")
import("winconditions/teamsolidarity.scar")

---------------------------------------------------------------------------------------------------
-- GUIDELINES AND SOME HELP
---------------------------------------------------------------------------------------------------
-- Core_CallDelegateFunctions("<suffix>")
---------------------------------------------------------------------------------------------------
-- AGS Calls:
---------------------------------------------------------------------------------------------------
-- ENTITY & UNIT SPAWNED 
-------------------------------------------------
-- EntitySpawned({pbg = entity_blueprint, player = player_id, entity = spawned_entity}) 
-- UnitsSpawned(player_id, position: home_position, sgroup: units)
-------------------------------------------------
-- AI PLAYER UPDATES
-------------------------------------------------
-- AdjustAIPlayer(player_id, ADJUSTREASON: reason)
-------------------------------------------------
-- SETTINGS & MODULE ADJUSTMENTS
-------------------------------------------------
-- SetupSettings(wincondition_options: options)
-- AdjustSettings 
-- ModuleSettings
-------------------------------------------------
-- INITIALIZATION BEFORE START
-------------------------------------------------
-- PresetSpawn 
-- PresetPostSpawn 
-------------------------------------------------
-- TREATY CONTROL
-------------------------------------------------
-- TreatyStarted
-- TreatyEnded
---------------------------------------------------------------------------------------------------
-- Relic Calls:
---------------------------------------------------------------------------------------------------
-- INITIALIZATION IN ORDER
-------------------------------------------------
-- OnGameSetup
-- OnGameRestore
-- PreInit
-- OnInit
-- PostInit
-- SetupVariables
-- SetDifficulty
-- SetRestrictions
-- Preset
-- InitComplete
-- PreStart
-- Start
-- PreGameOver
-- OnGameOver
-------------------------------------------------
-- DIPLOMACY STATE
-------------------------------------------------
-- TributeEnabled
-- OnTributeSent
-- DiplomacyEnabled
-- OnRelationshipChanged // due to non existing GE_RelationChanged
-- OnPlayerLeftTeam
-- OnTeamCreated
-- OnTeamRemoved
-- OnPlayerJoinedTeam
-------------------------------------------------
-- PLAYER MATCH STATE
-------------------------------------------------
-- OnLeaveGameMatchRequested
-- OnSurrenderMatchRequested
-- OnPlayerDefeated
-- OnTeamDefeated
-- OnPlayerAITakeover
-------------------------------------------------
-- IRRELEVANT
-------------------------------------------------
-- ActivateMenuItem
-- StartWithCheat
-- RegisterEncounterPlans
-- UnitEntry_PreprocessDeployment
-- UnitEntry_StartDeployment
-- UnitEntry_EndDeployment
-- UnitEntry_CreateUnit
-- UnitEntry_SpawnUnit
-- UnitEntry_SpawnUnit_Finish
-- UnitEntry_RegisterEntryMethods
-- OnConstructionComplete // Was invoked only be Relic StartConditions after TC was spawned.
---------------------------------------------------------------------------------------------------
-- Expected Order:
-- 1. OnGameSetup
-- 2. SetupSettings
-- 3. AdjustSettings
-- 4. UpdateModuleSettings
--
-- 20. PreInit
-- 21. OnInit
-- 22. PostInit
--
-- 30. Preset
-- 31. PresetSpawn
-- 32. PresetPostSpawn
--
-- 40. PreStart
-- 41. Start
--
-- 50. TreatyStarted
-- 51. TreatyEnded
--
-- 100. OnGameOver
---------------------------------------------------------------------------------------------------
-- Global events should be handled by OnEvent methods, here is list that is currently used.
---------------------------------------------------------------------------------------------------
-- GE_ConstructionComplete -> OnContructionComplete 
-- GE_EntityKilled -> OnEntityKilled
-- GE_SquadKilled -> OnSquadKilled
-- GE_ProjectileFired -> OnProjectileFired
-- GE_ProjectileLanded -> OnProjectileLanded
-- GE_UpgradeComplete -> OnUpgradeComplete
-- GE_PlayerNameChanged -> OnPlayerNameChanged
-- GE_PlayerAddResource -> OnPlayerAddResource
-- GE_PlayerTeamIdUpdated -> OnPlayerTeamIdUpdated TODO from OnPlayerTeamChanged
-- GE_EntityLandmarkDestroyed -> OnEntityLandmarkDestroyed TODO from OnLandmarkDestroyed
-- GE_LocalPlayerChanged -> OnLocalPlayerChanged
-- GE_StrategicPointChanged -> OnStrategicPointChanged TODO from OnHolySiteChange 
-- GE_DamageReceived -> OnDamageReceived 
-- GE_ConstructionStart -> OnConstructionStart
---------------------------------------------------------------------------------------------------
-- TODO:
-- Go and organize Player_, Core_ methods better as Core_GetPlayersTableEntry is shortcut for Player_
---------------------------------------------------------------------------------------------------